{"ast":null,"code":"var _jsxFileName = \"C:\\\\IDA\\\\idg2100-202-exam-delivery-folder-group-4\\\\client\\\\src\\\\HOC\\\\Main.jsx\";\n// Inspired by Carlos's lecture\n\nimport React, { Component } from \"react\";\nimport AuthContext from \"../utils/AuthContextProvider\";\nimport { getBrews, getBeans, checkRating, postRating, updateRating, fetchRatings } from \"../api/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Main(WrappedComponent) {\n  class BrewCompontent extends Component {\n    constructor(props) {\n      super(props);\n      this.calcAvergareRating = data => {\n        const arr = [];\n        data.map(item => arr.push(item.rating));\n        this.setState({\n          avgRating: arr.reduce((a, b) => a + b) / arr.length\n        });\n      };\n      this.fetchData = async () => {\n        this.setState({\n          loading: true\n        });\n        await getBrews().then(response => {\n          this.setState({\n            brewStatus: response.data[0]\n          });\n        });\n        await getBeans().then(response => {\n          this.setState({\n            coffeeBeans: []\n          });\n          response.data.map(bean => this.setState(prevState => ({\n            coffeeBeans: [...prevState.coffeeBeans, bean.name]\n          })));\n        });\n        await fetchRatings(this.state.brewStatus._id).then(response => {\n          response.data.length !== 0 && this.calcAvergareRating(response.data);\n        });\n        this.setState({\n          loading: false\n        });\n      };\n      this.setRating = async rating => {\n        this.setState({\n          rating: rating\n        });\n        const newRating = async () => {\n          await postRating(this.state.brewStatus._id, this.context.user.id, this.state.rating, this.state.brewStatus.brewName, this.state.brewStatus.grind, this.state.brewStatus.water, this.state.brewStatus.gram, this.state.brewStatus.createdAt);\n        };\n        await checkRating(this.context.user.id, this.state.brewStatus._id).then(response => {\n          response.data.length === 0 ? newRating() : updateRating(this.context.user.id, this.state.brewStatus._id, this.state.rating, this.state.brewStatus.brewName, this.state.brewStatus.grind, this.state.brewStatus.water, this.state.brewStatus.gram, this.state.brewStatus.createdAt);\n        });\n      };\n      this.state = {\n        loading: true,\n        brewStatus: {},\n        coffeeBeans: [],\n        rating: 0,\n        avgRating: 0\n      };\n      this.fetchData = this.fetchData.bind(this);\n      this.setRating = this.setRating.bind(this);\n    }\n    componentDidMount() {\n      this.setState({\n        loading: true\n      });\n      this.fetchData();\n    }\n    componentDidUpdate(prevProps) {\n      if (prevProps.UpdatedBrewStatus !== this.props.UpdatedBrewStatus) {\n        this.fetchData();\n      }\n    }\n    render() {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: !this.state.loading ? /*#__PURE__*/_jsxDEV(WrappedComponent, {\n          ...this.state,\n          handlePage: this.props.handlePage,\n          setUpdatedBrewStatus: this.props.setUpdatedBrewStatus,\n          setRating: this.setRating,\n          fetchData: this.fetchData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this) : \"Loading...\"\n      }, void 0, false);\n    }\n  }\n  BrewCompontent.contextType = AuthContext;\n  return BrewCompontent;\n}\n_c = Main;\nexport default Main;\nvar _c;\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"names":["React","Component","AuthContext","getBrews","getBeans","checkRating","postRating","updateRating","fetchRatings","Main","WrappedComponent","BrewCompontent","constructor","props","calcAvergareRating","data","arr","map","item","push","rating","setState","avgRating","reduce","a","b","length","fetchData","loading","then","response","brewStatus","coffeeBeans","bean","prevState","name","state","_id","setRating","newRating","context","user","id","brewName","grind","water","gram","createdAt","bind","componentDidMount","componentDidUpdate","prevProps","UpdatedBrewStatus","render","handlePage","setUpdatedBrewStatus","contextType"],"sources":["C:/IDA/idg2100-202-exam-delivery-folder-group-4/client/src/HOC/Main.jsx"],"sourcesContent":["// Inspired by Carlos's lecture\r\n\r\nimport React, { Component } from \"react\";\r\nimport AuthContext from \"../utils/AuthContextProvider\";\r\nimport {\r\n    getBrews,\r\n    getBeans,\r\n    checkRating,\r\n    postRating,\r\n    updateRating,\r\n    fetchRatings,\r\n} from \"../api/api\";\r\n\r\nfunction Main(WrappedComponent) {\r\n  class BrewCompontent extends Component {\r\n    static contextType = AuthContext;\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        loading: true,\r\n        brewStatus: {},\r\n        coffeeBeans: [],\r\n        rating: 0,\r\n        avgRating: 0,\r\n      };\r\n      this.fetchData = this.fetchData.bind(this);\r\n      this.setRating = this.setRating.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n      this.setState({ loading: true });\r\n      this.fetchData();\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n      if (prevProps.UpdatedBrewStatus !== this.props.UpdatedBrewStatus) {\r\n        this.fetchData();\r\n      }\r\n    }\r\n\r\n    calcAvergareRating = (data) => {\r\n      const arr = [];\r\n      data.map((item) => arr.push(item.rating));\r\n      this.setState({ avgRating: arr.reduce((a, b) => a + b) / arr.length });\r\n    };\r\n\r\n    fetchData = async () => {\r\n      this.setState({ loading: true });\r\n      \r\n      await getBrews().then((response) => {\r\n        this.setState({ brewStatus: response.data[0] });\r\n      });\r\n\r\n     \r\n      await getBeans().then((response) => {\r\n        this.setState({ coffeeBeans: [] });\r\n        response.data.map((bean) =>\r\n          this.setState((prevState) => ({\r\n            coffeeBeans: [...prevState.coffeeBeans, bean.name],\r\n          }))\r\n        );\r\n      });\r\n\r\n      await fetchRatings(this.state.brewStatus._id).then((response) => {\r\n        response.data.length !== 0 && this.calcAvergareRating(response.data);\r\n      });\r\n\r\n      this.setState({ loading: false });\r\n    };\r\n\r\n \r\n    setRating = async (rating) => {\r\n      this.setState({ rating: rating });\r\n      const newRating = async () => {\r\n        await postRating(\r\n          this.state.brewStatus._id,\r\n          this.context.user.id,\r\n          this.state.rating,\r\n          this.state.brewStatus.brewName,\r\n          this.state.brewStatus.grind,\r\n          this.state.brewStatus.water,\r\n          this.state.brewStatus.gram,\r\n          this.state.brewStatus.createdAt\r\n        );\r\n      };\r\n\r\n      await checkRating(this.context.user.id, this.state.brewStatus._id).then(\r\n        (response) => {\r\n          response.data.length === 0\r\n            ? newRating()\r\n            : updateRating(\r\n                this.context.user.id,\r\n                this.state.brewStatus._id,\r\n                this.state.rating,\r\n                this.state.brewStatus.brewName,\r\n                this.state.brewStatus.grind,\r\n                this.state.brewStatus.water,\r\n                this.state.brewStatus.gram,\r\n                this.state.brewStatus.createdAt\r\n              );\r\n        }\r\n      );\r\n    };\r\n\r\n    render() {\r\n      return (\r\n        <>\r\n          {!this.state.loading ? (\r\n            <WrappedComponent\r\n              {...this.state}\r\n              handlePage={this.props.handlePage}\r\n              setUpdatedBrewStatus={this.props.setUpdatedBrewStatus}\r\n              setRating={this.setRating}\r\n              fetchData={this.fetchData}\r\n            />\r\n          ) : (\r\n            \"Loading...\"\r\n          )}\r\n        </>\r\n      );\r\n    }\r\n  }\r\n\r\n  return BrewCompontent;\r\n}\r\n\r\nexport default Main;"],"mappings":"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"},"metadata":{},"sourceType":"module"}